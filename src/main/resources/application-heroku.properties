spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${JDBC_DATABASE_USERNAME}
spring.datasource.password=${JDBC_DATABASE_PASSWORD}
server.port=${PORT:8080}

# Serve static content
spring.web.resources.static-locations=file:/app/static/
spring.mvc.static-path-pattern=/**

# Memory optimization
spring.jpa.properties.hibernate.jdbc.batch_size=30
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true
spring.jpa.hibernate.ddl-auto=none
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.mvc.pathmatch.matching-strategy=ant_path_matcher

# Redis configuration (Heroku Redis add-on provides REDIS_URL)
spring.data.redis.url=${REDIS_URL}
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0
spring.data.redis.lettuce.pool.max-wait=2000ms

# Spring Session Redis configuration
spring.session.store-type=redis
spring.session.redis.namespace=budgetbuddy:session
spring.session.timeout=30m
spring.session.redis.flush-mode=on_save
spring.session.redis.cleanup-cron=0 * * * * *

# Email settings
spring.mail.host=${MAIL_HOST:smtp.sendgrid.net}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:apikey}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Allow bean definition overriding

# Logging
logging.level.root=INFO
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.com.app.budgetbuddy=DEBUG
logging.level.org.hibernate=INFO
spring.sql.init.mode=always
spring.sql.init.schema-locations=file:/app/db/dbInit.sql
spring.sql.init.continue-on-error=true
